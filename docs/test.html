<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src=https://code.jquery.com/jquery-3.2.1.min.js></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(main);

      // function drawChart() {
      //   var data = google.visualization.arrayToDataTable([
      //     ['Year', 'Sales', 'Expenses'],
      //     ['2004',  1000,      400],
      //     ['2005',  1170,      460],
      //     ['2006',  660,       1120],
      //     ['2007',  1030,      540]
      //   ]);

      //   var options = {
      //     title: 'Company Performance',
      //     curveType: 'function',
      //     legend: { position: 'bottom' }
      //   };

      //   // var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

      //   // chart.draw(data, options);
      // }

      function drawChart(data) {
        console.log(data);
        data = google.visualization.arrayToDataTable(data);
        var options = { title: 'Coarse-grained Performance' };
        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }

      function processData(data) {
        var lines = data.split("\n");
        var newData = lines.map(function(x, i) {
          var info = x.split(",");
          if (i == 0) {
            return info;
          }

          return [parseInt(info[0])].concat(
            info.slice(1).map(parseFloat));

        });
        return newData;
      }

      function loadData(csvName) {
        $.ajax(csvName, {
          datatype: "text",
          mimeType: "text/plain"
        })
          .done(function(data) {
            drawChart(processData(data));
          })
          .fail(function() {
            console.log("error");
          });
      }

      function main() {
        loadData('data/coarse-ghc43-proc.csv');
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width:1500px; height:900px"/>
    <script>
    </script>
  </body>
</html>