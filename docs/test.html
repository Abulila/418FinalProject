<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src=https://code.jquery.com/jquery-3.2.1.min.js></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(main);

      function drawChart(name, graphTitle) {

        $.ajax("data/" + name + "-proc.csv", {
          datatype: "text",
          mimeType: "text/plain"
        })
          .done(function(data) {
            var dataTable = google.visualization.arrayToDataTable(processData(data));
            var options = {
              title: graphTitle,
              pointSize: 5,
              hAxis: {
                title: 'Threads'
              },
              vAxis: {
                title: 'Execution Time (ms)'
              }
            };
            var chart = new google.visualization.LineChart(document.getElementById(name + "_div"));
            chart.draw(dataTable, options);
          })
          .fail(function(x, err) {
            console.log("error: ", err);
          });
      }

      function processData(data) {
        var lines = data.split("\n");
        var newData = lines.map(function(x, i) {
          var info = x.split(",");
          if (i == 0) {
            return info;
          }

          return [parseInt(info[0])].concat(
            info.slice(1).map(parseFloat));

        });
        return newData;
      }

      function main() {
        drawChart('coarse', 'Write-Intensive, Coarse-Grained Locking');
        drawChart('fine', 'Write-Intensive, Fine-Grained Locking');
        drawChart('fine-rw', 'Write-Intensive, Fine-Grained RW Locking');
        drawChart('lockfree', 'Write-Intensive, Lock Free');

        drawChart('coarse-read', 'Read-Intensive, Coarse-Grained Locking');
        drawChart('fine-read', 'Read-Intensive, Fine-Grained Locking');
        drawChart('fine-rw-read', 'Read-Intensive, Fine-Grained RW Locking');
        drawChart('lockfree-read', 'Read-Intensive, Lock Free');

        drawChart('low-cont', 'Write-Intensive Performance Under Low Contention');
        drawChart('high-cont', 'Write-Intensive Performance Under High Contention');

        drawChart('low-cont-read', 'Read-Intensive Performance Under Low Contention');
        drawChart('high-cont-read', 'Read-Intensive Performance Under High Contention');
      }
    </script>
  </head>
  <body>
    <div id="coarse_div" style="width:1500px; height:900px"></div>
    <div id="fine_div" style="width:1500px; height:900px"></div>
    <div id="fine-rw_div" style="width:1500px; height:900px"></div>
    <div id="lockfree_div" style="width:1500px; height:900px"></div>
    
    <div id="coarse-read_div" style="width:1500px; height:900px"></div>
    <div id="fine-read_div" style="width:1500px; height:900px"></div>
    <div id="fine-rw-read_div" style="width:1500px; height:900px"></div>
    <div id="lockfree-read_div" style="width:1500px; height:900px"></div>

    <div id="low-cont_div" style="width:1500px; height:900px"></div>
    <div id="high-cont_div" style="width:1500px; height:900px"></div>

    <div id="low-cont-read_div" style="width:1500px; height:900px"></div>
    <div id="high-cont-read_div" style="width:1500px; height:900px"></div>
  </body>
</html>